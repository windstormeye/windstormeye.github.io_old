<!DOCTYPE html><html lang="zh-Hans"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="ä¹Ÿå°±éª‘ä¸ªè½¦ï¼Œé¡ºä¾¿å†™ç‚¹ç ï¼Œå†å»çœ‹çœ‹æ™¯"><title>æäº‹æƒ…ä¹‹å¦‚ä½•å¿«é€Ÿå®Œæˆ IM | PJHubs</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=1.0.0"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/normalize.css/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/purecss/build/pure-min.min.css"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/purecss/build/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><script type="text/javascript" src="//cdn.jsdelivr.net/npm/clipboard/dist/clipboard.min.js"></script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/codeseven/toastr/build/toastr.min.js"></script><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/codeseven/toastr/build/toastr.min.css"><meta name="generator" content="Hexo 6.2.0"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">æäº‹æƒ…ä¹‹å¦‚ä½•å¿«é€Ÿå®Œæˆ IM</h1><a id="logo" href="/.">PJHubs</a><p class="description">ä¹Ÿå°±éª‘ä¸ªè½¦ï¼Œé¡ºä¾¿å†™ç‚¹ç ï¼Œå†å»çœ‹çœ‹æ™¯</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa undefined"> æ–‡ç« </i></a><a href="/archives/"><i class="fa undefined"> æ€»è§ˆ</i></a><a href="/photograph/"><i class="fa undefined"> æ‘„å½±</i></a><a href="/about/"><i class="fa undefined"> å…³äº</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">æäº‹æƒ…ä¹‹å¦‚ä½•å¿«é€Ÿå®Œæˆ IM</h1><div class="post-meta">2019-04-27</div><div class="post-content"><blockquote>
<p>æäº‹æƒ…ç³»åˆ—æ–‡ç« ä¸»è¦æ˜¯ä¸ºäº†ç»§ç»­å»¶ç»­è‡ªå·±çš„ â€œTâ€ å­—å½¢æˆ˜ç•¥æ‰€åšï¼ŒåŒæ—¶ä¹Ÿä»£è¡¨ç€æ¯•è®¾ç›¸å…³å†…å®¹çš„å­¦ä¹ æ€»ç»“ã€‚æœ¬æ–‡ç« æ˜¯å¿«é€Ÿå¯¹æ¥å³æ—¶é€šè®¯å®Œæˆéœ€æ±‚ï¼Œä¸»è¦æ˜¯è®°å½•åœ¨é›†æˆå³æ—¶é€šè®¯çš„è¿‡ç¨‹ä¸­é‡åˆ°çš„ä¸€äº›é—®é¢˜å’Œæ€»ç»“ã€‚</p>
</blockquote>
<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æ¥å…¥å³æ—¶é€šè®¯æ˜¯å¤§ä¸€çš„æ¯”èµ›ä½œå“â€œ<a target="_blank" rel="noopener" href="https://github.com/windstormeye/CampusPlus">å¤§å­¦+</a>â€ï¼Œå½“æ—¶å’Œå¦å¤–ä¸€ä¸ªå°ä¼™ä¼´ä¸€èµ·å†™ä¸‹ç¬¬ä¸€è¡Œä»£ç ï¼Œåˆ°é ç€è¿™ä¸ªä½œå“ç ä¸‹äº†ä¸€äº›å°å¥–ï¼ŒåŒæ—¶ä¹Ÿè®©å½“æ—¶çš„è‡ªå·±å¿«é€Ÿçš„å…¥é—¨äº†ä¸ iOS å¼€å‘ç›¸å…³ä¸€éƒ¨åˆ†å†…å®¹ã€‚</p>
<p>ç°åœ¨è¦åœ¨æ¯•è®¾ä¸­åŒæ ·æ¥å…¥ IMï¼Œè°ƒç ”äº†ç›®å‰æ¯”è¾ƒæµè¡Œçš„ IM æœåŠ¡æä¾›å•†åï¼Œæœ€ç»ˆé€‰æ‹©äº†<strong>èäº‘</strong>è´Ÿè´£å³æ—¶èŠå¤©ä¸šåŠ¡ã€‚åœ¨è°ƒç ”çš„è¿‡ç¨‹ä¸­é™¤äº†èƒ½å¤Ÿæä¾›ç¨³å®šçš„åŸºç¡€èŠå¤©æœåŠ¡ï¼Œæœ€å¥½è¿˜è¦æœ‰ä¸ª <code>UIKit</code>ï¼Œå› ä¸ºè‡ªå·±çš„æ—¶é—´å¹¶ä¸å¤šï¼Œæƒ³ç€ç›´æ¥åœ¨ IM æœåŠ¡æä¾›å•†æ‰€å¸¦çš„ <code>UIKit</code> åšäºŒæ¬¡å¼€å‘ã€‚</p>
<h2 id="IM-æœåŠ¡æä¾›å•†è°ƒç ”"><a href="#IM-æœåŠ¡æä¾›å•†è°ƒç ”" class="headerlink" title="IM æœåŠ¡æä¾›å•†è°ƒç ”"></a>IM æœåŠ¡æä¾›å•†è°ƒç ”</h2><h3 id="é˜¿é‡Œäº‘"><a href="#é˜¿é‡Œäº‘" class="headerlink" title="é˜¿é‡Œäº‘"></a>é˜¿é‡Œäº‘</h3><p>ä¸çŸ¥ä¸ºä½•ï¼Œæˆ‘å¯¹é˜¿é‡Œäº‘çš„äº§å“æ€»æ˜¯æä¸èµ·æ¥å…´è¶£ã€‚æœ€å¼€å§‹æ˜¯æ¥å…¥äº†é˜¿é‡Œäº‘çŸ­ä¿¡åšéªŒè¯ç ï¼Œåœ¨å¯¹æ¥çš„è¿‡ç¨‹ä¸­æˆ‘ä¸æ˜¯å¾ˆå–œæ¬¢é˜¿é‡Œäº‘çš„åšæ³•ï¼Œé˜¿é‡Œäº‘çŸ­ä¿¡çš„ server SDK åªæä¾›ä¸€ä¸ªè·Ÿè¿è¥å•†çš„é€šé“ï¼Œè‡³äºçŸ­ä¿¡éªŒè¯ç çš„å†…å®¹ï¼Œéœ€è¦æˆ‘ä»¬è‡ªå·±åšç»´æŠ¤ï¼ŒåŒ…æ‹¬éªŒè¯ç çš„ç”Ÿæˆã€åŒ¹é…å’Œè¿‡æœŸã€‚</p>
<p>è€Œç›¸å¯¹æˆ‘ä¹‹å‰ä¸€ç›´åœ¨ä½¿ç”¨ mob æ¥è¯´ï¼ŒåŒæ ·å¯ä»¥é€‰æ‹© client è§¦å‘çŸ­ä¿¡éªŒè¯ç çš„å‘é€ï¼Œè€Œ server è¦åšçš„äº‹æƒ…ä»…ä»…åªæ˜¯åŒ¹é…è€Œå·²ï¼Œä¸éœ€è¦å¯¹éªŒè¯ç çš„ç”Ÿæˆå’Œè¿‡æœŸåšå¤„ç†ã€‚</p>
<p>å½“ç„¶è¿™ä¸€ç‚¹çœ‹æ³•æ™ºè€…è§æ™ºï¼Œå¯¹äºæˆ‘ä¸ªäººæ¥è¯´ï¼ŒçŸ­ä¿¡éªŒè¯ç å¹¶ä¸æ˜¯æ ¸å¿ƒä¸šåŠ¡ï¼Œè™½ç„¶æ•´ä¸ªå¯¹æ¥è¿‡ç¨‹ä¹Ÿä¸å¤æ‚ï¼Œä½†æ•´ä½“æƒ…å†µå¯¹æ¯”æ¥çœ‹æˆ‘ä¸æ˜¯å¾ˆèˆ’æœã€‚æœ€é‡è¦çš„æ˜¯å¦‚æœä½ è¦æµ‹è¯•é˜¿é‡Œäº‘çŸ­ä¿¡å¿…é¡»å¾—å…ˆå……é’±ï¼Œè¿™å…¶å®å°±é™·å…¥äº†ä¸€ä¸ªæ­»å¾ªç¯â€œæˆ‘çš„é€»è¾‘è¿˜æ²¡è·‘é€šï¼Œå‡­ä»€ä¹ˆå…ˆäº¤é’±ï¼Ÿä¸äº¤é’±æ€ä¹ˆå¼€é€šæœåŠ¡ï¼Ÿâ€ï¼Œä¸€æ¡çŸ­ä¿¡è™½ç„¶ä¹Ÿæ²¡å‡ ä¸ªé’±ï¼Œä½†ç¡®å®ä¼šè®©äººä¸å¤ªçˆ½ã€‚åè§‚ mob æä¾›äº†å¼€å‘ç¯å¢ƒæ¯å¤© 20 æ¡å…è´¹çŸ­ä¿¡ç”¨äºæµ‹è¯•ã€‚</p>
<p>ç»è¿‡æ¥å…¥é˜¿é‡Œäº‘çŸ­ä¿¡çš„è¿‡ç¨‹åï¼Œæˆ‘å¯¹é˜¿é‡Œäº‘ç³»äº§å“å°±å¤±å»äº†å…´è¶£ï¼ŒåŒ…æ‹¬é˜¿é‡Œäº‘é€šä¿¡ã€‚</p>
<h3 id="è…¾è®¯äº‘"><a href="#è…¾è®¯äº‘" class="headerlink" title="è…¾è®¯äº‘"></a>è…¾è®¯äº‘</h3><p>åœ¨è°ƒç ”è…¾è®¯äº‘ IM çš„è¿‡ç¨‹ä¸­ï¼Œå®˜ç½‘ä¸Šçš„è¿™å¥å®£ä¼ è¯­çœŸæ˜¯ç›´å‡»å†…å¿ƒã€‚</p>
<blockquote>
<p>è…¾è®¯æ˜¯å›½å†…æœ€å¤§ä¹Ÿæ˜¯æœ€æ—©çš„å³æ—¶é€šè®¯å¼€å‘å•†ï¼ŒQQ å’Œå¾®ä¿¡å·²ç»æˆä¸ºæ¯ä¸ªäº’è”ç½‘ç”¨æˆ·å¿…ä¸å¯å°‘çš„åº”ç”¨ã€‚ç°åœ¨ï¼Œè…¾è®¯å°†é«˜å¹¶å‘ã€é«˜å¯é çš„å³æ—¶é€šè®¯èƒ½åŠ›è¿›è¡Œå¼€æ”¾ï¼Œå¼€å‘è€…å¯ä»¥å¾ˆå®¹æ˜“çš„æ ¹æ®è…¾è®¯æä¾›çš„ SDK å°†å³æ—¶é€šè®¯åŠŸèƒ½é›†æˆå…¥ App ä¸­ã€‚</p>
</blockquote>
<p>è¿™è¿˜æœ‰ä»€ä¹ˆå¥½æŒ‘çš„ï¼Ÿå½“æ—¶å†³å®šç«‹é©¬æ¥å…¥ï¼Œå…¶å®ƒä¸è°ƒç ”äº†ã€‚</p>
<h4 id="æ–‡æ¡£ï¼Ÿï¼Ÿï¼Ÿ"><a href="#æ–‡æ¡£ï¼Ÿï¼Ÿï¼Ÿ" class="headerlink" title="æ–‡æ¡£ï¼Ÿï¼Ÿï¼Ÿ"></a>æ–‡æ¡£ï¼Ÿï¼Ÿï¼Ÿ</h4><p>è…¾è®¯äº‘é€šä¿¡çš„ iOS SDK åº”è¯¥æ˜¯å»å¹´ 8 æœˆä»½å·¦å³åšäº†æ›´æ–°ï¼Œæ„Ÿè§‰å¾ˆè¸å®ã€‚å½“åˆå§‹åŒ–å®Œ <code>AppKey</code> åå‡†å¤‡æ¥å…¥â€œæ¶ˆæ¯åˆ—è¡¨ VCâ€æ—¶æˆ‘æ­»æ´»æ‰¾ä¸åˆ°å®˜ç½‘æ–‡æ¡£ä¸Šæè¿°çš„ç±»ã€‚</p>
<p>åæ¥æˆ‘æ€€ç–‘ä¼°è®¡æ˜¯å¶ç„¶é—®é¢˜ï¼Œå‡­ç€è‡ªå·±çš„ç»éªŒï¼ŒçŒœå‡ºäº†æ­£ç¡®çš„â€œæ¶ˆæ¯åˆ—è¡¨ VCâ€ç±»ï¼Œå¹¶æˆåŠŸçš„åˆå§‹åŒ–ï¼Œæ¥ç€å¼€å§‹å¯¹æ¥â€œä¼šè¯ç•Œé¢ VCâ€ï¼Œä¹Ÿå°±æ˜¯ <code>AddC2CController</code>ï¼Œä¸€å¼€å§‹ Xcode å¹¶æ²¡æœ‰è¿›è¡Œä»£ç è¡¥å…¨çš„æç¤ºï¼Œä»¥ä¸ºæ˜¯ Xcode æœ¬èº«çš„é—®é¢˜ï¼Œå¼€å§‹çš„æ¸…ç¼“å­˜ã€é‡å¯ Xcode ç­‰æ“ä½œï¼ŒæŠŠå·¥ç¨‹æ¢å¤åˆ°äº†æœ€ä½³ï¼Œå¯å½“æˆ‘æœ€åä¸€æ¬¡æ•²ä¸‹ <code>AddC2CController</code> æ—¶ï¼Œä¾ç„¶æ²¡æœ‰æç¤ºã€‚</p>
<p>ç¿»äº†ä¸€é pods ä¸­ <code>TUIKit</code> ä¸­çš„æ‰€æœ‰ç±»ï¼ŒæƒŠå¥‡çš„å‘ç°å±…ç„¶æ²¡æœ‰ <code>AddC2CController</code> è¿™ä¸ªç±»ï¼åå¤ä»å®˜æ–¹æ–‡æ¡£ä¸­ä¸Šä¸‹æ±‚ç´¢ï¼Œå¯æœ€ç»ˆçš„ç»“æœæ˜¯ï¼Œæˆ‘åˆå‡­ç€è‡ªå·±çš„ç»éªŒæ‰¾åˆ°äº†ç›¸ä¼¼çš„ç±»åï¼Œä½†åˆå§‹åŒ–å®Œæˆåï¼Œå¹¶ä¸æ˜¯æˆ‘æƒ³è¦çš„ç»“æœï¼Œæ€»ä¸èƒ½æŠŠæ‰€æœ‰ç±»éƒ½åˆå§‹åŒ–ä¸€éå§ï¼Ÿ</p>
<p>æœ€åæ— æ³•å¿å—ï¼Œå¾ˆä¸å¼€å¿ƒçš„å‘äº†å·¥å•ã€‚ç­‰å¾…äº†ä¸€ä¸ªæ˜ŸæœŸåï¼Œæ–‡æ¡£ä¾æ—§æ²¡æœ‰æ›´æ–°ï¼Œæˆ‘å½»åº•æ”¾å¼ƒäº†ã€‚åˆšæ‰åˆå»çœ‹äº†ä¸€çœ¼ï¼Œå—¯ï¼Œä¾æ—§æ²¡æœ‰æ›´æ–°â€¦â€¦</p>
<h3 id="ç½‘æ˜“äº‘ä¿¡"><a href="#ç½‘æ˜“äº‘ä¿¡" class="headerlink" title="ç½‘æ˜“äº‘ä¿¡"></a>ç½‘æ˜“äº‘ä¿¡</h3><p>ä¸ªåˆ«å¤§ä½¬ä¸æ¨èä½¿ç”¨ï¼Œæ®è¯´è¦å‡‰äº†ï¼Œé‚£æˆ‘å°±ç®—äº†å§ã€‚</p>
<h3 id="leanCloud"><a href="#leanCloud" class="headerlink" title="leanCloud"></a>leanCloud</h3><p>ä¹‹å‰å°±å¬è¯´äº† leanCloud å…¨å®¶æ¡¶å¾ˆé¦™ã€‚æœ¬æ¥ä¹Ÿæ‰“ç®—ä¸Š leanCloud å…¨å®¶æ¡¶ï¼Œä½†ç²—ç•¥çš„æ–‡æ¡£çœ‹è¿‡å»æ€ä¹ˆå¥½åƒéƒ½è·Ÿå…¶äº‘æ•°æ®åº“ç»‘å®šåˆ°äº†ä¸€èµ·ï¼Œè·Ÿä¹‹å‰å¤§ä¸€æ—¶æˆ‘å’Œå¦å¤–ä¸€ä¸ªå°ä¼™ä¼´ä¸ä¼šå†™æ•°æ®åº“ï¼Œä½¿ç”¨äº†å½“æ—¶æ¯”è¾ƒç«çš„äº‘æ•°æ®åº“æä¾›å•† Bmob åšæ³•ç±»ä¼¼ï¼Œå†åŠ ä¸Šè¢«å‰é¢è…¾è®¯äº‘æå¾—æœ‰äº›ç–²æƒ«äº†ï¼Œå¯¹å…¨æ–°äº‹ç‰©å·²ç»å¾ˆéš¾æèµ·å…´è¶£äº†ï¼Œåªæƒ³ç€èƒ½å¤Ÿè¶Šå¿«è§£å†³è¿™ä¸ªé—®é¢˜å°±å¥½ã€‚</p>
<h3 id="èäº‘"><a href="#èäº‘" class="headerlink" title="èäº‘"></a>èäº‘</h3><p>æœ€åå†ä¸‰æ€è€ƒåï¼Œè¿˜æ˜¯å›åˆ°äº†èäº‘ä¸Šã€‚åˆšå¼€å§‹ä¹Ÿç¡®å®æ‰“ç®—ç›´æ¥ä½¿ç”¨èäº‘çš„ <code>UIKit</code>ï¼Œä½†ä»”ç»†å¯¹æ¯”äº†èäº‘ <code>UIKit</code> èƒ½å¤Ÿæä¾›å®šåˆ¶åŒ–çš„åœ°æ–¹å’Œ UI è®¾è®¡å›¾æœ€ç»ˆçš„æ•ˆæœå·®è·ç”šè¿œï¼Œé‚æ”¾å¼ƒï¼Œå‡†å¤‡åªæ¥å…¥èäº‘çš„æ ¸å¿ƒé€šä¿¡åº“ï¼Œä½¿ç”¨ç¬¬ä¸‰æ–¹ IM UI åº“å®Œæˆã€‚</p>
<h2 id="UI-åº“è°ƒç ”"><a href="#UI-åº“è°ƒç ”" class="headerlink" title="UI åº“è°ƒç ”"></a>UI åº“è°ƒç ”</h2><p>æœ€å¼€å§‹æˆ‘æ˜¯æƒ³çœäº‹ç›´æ¥ç”¨ IM æœåŠ¡æä¾›å•†çš„ <code>UIKit</code>ï¼Œä½†åœ¨çœ‹è¿‡äº†è…¾è®¯äº‘å’Œèäº‘æä¾›çš„ UI å®šåˆ¶å¤ªå±€é™äº†ï¼Œè€Œä¸”ä¸ç®¡æ€ä¹ˆåšï¼Œéƒ½å¾ˆéš¾å¤åˆ»å‡ºè·Ÿè®¾è®¡å›¾ä¸€æ ·çš„æ•ˆæœã€‚</p>
<p><img src="https://i.loli.net/2019/04/26/5cc2e8be8f93b.png" alt="IM UI"></p>
<p><img src="https://i.loli.net/2019/04/26/5cc2e8be9210d.png" alt="IM UI"></p>
<h3 id="MessagerKit"><a href="#MessagerKit" class="headerlink" title="MessagerKit"></a>MessagerKit</h3><p>github åœ°å€ï¼š<a target="_blank" rel="noopener" href="https://github.com/steve228uk/MessengerKit">https://github.com/steve228uk/MessengerKit</a>ã€‚</p>
<p>ä¸€å¼€å§‹çœ‹ä¸Šäº†è¿™ä¸ªåº“ï¼ŒåŸºæœ¬ä¸ŠæŠŠå¤§éƒ¨åˆ†åŠŸèƒ½éƒ½å®ç°äº†ï¼Œä½†æ˜¯è·Ÿè®¾è®¡å›¾ä¸Šçš„ä¸€äº›ç»†èŠ‚è¿˜æ˜¯æœ‰å·®è·ï¼Œæ¯”å¦‚è¯´éœ€è¦è‡ªå·±çš„åšæ‹“å±•æ”¯æŒè¯­éŸ³ã€åœ°å›¾ç­‰è‡ªå®šä¹‰æ¶ˆæ¯ä½“ã€æ¶ˆæ¯ä½“æ¡†ç‰¹æ®Šåœ†è§’ã€‚è¿™éƒ¨åˆ†å·¥ä½œæ˜¯æ¸…æ˜èŠ‚å›å®¶åšçš„ï¼Œæ•´ä½“ä¸Šå¯¹æ¥å®Œæˆåå…¶å®è¿˜ç®— OKã€‚</p>
<h3 id="MessageKit"><a href="#MessageKit" class="headerlink" title="MessageKit"></a>MessageKit</h3><p>ç›´åˆ°æœ‰ä¸€å¤©ä¸­åˆï¼Œçªç„¶çœ‹åˆ°äº† <a target="_blank" rel="noopener" href="https://github.com/MessageKit/MessageKit">MessageKit</a> è¿™ä¸ªåº“ï¼å‡ ä¹å®Œæˆäº†æ‰€æœ‰åŠŸèƒ½ï¼ŒæŠŠæˆ‘å¼€å¿ƒåäº†ï¼ç«‹é©¬ç€æ‰‹å¼€å§‹å…¨éƒ¨åˆ‡æ¢ã€‚</p>
<p>ç­‰åˆ°è°ƒå¥½äº†ä¸€åˆ‡ç»†èŠ‚åï¼Œå‘ç°è¿™ä¸ªåº“æœ‰ä¸€ä¸ªå‘çˆ¹çš„åœ°æ–¹ï¼Œç‚¹å‡»è¾“å…¥æ¡†æ•´ä¸ªèŠå¤©ç•Œé¢çš„ <code>collectionView</code> ä¼šä¸Šç§»ä¸€ä¸ªå›ºå®šè·ç¦»ï¼Œä¸ç®¡æˆ‘æ€ä¹ˆè°ƒï¼Œç”šè‡³æŠŠå®˜æ–¹ demo æ”¾åˆ°æˆ‘çš„å·¥ç¨‹é‡Œä¹ŸåŒæ ·ä¼šå‡ºç°è¿™ä¸ªé—®é¢˜ï¼Œç»§ç»­æŠ˜è…¾äº†å°†è¿‘ä¸€ä¸ªå°æ—¶åï¼Œæ”¾å¼ƒäº†ã€‚æ— ç¼˜æ— æ•…ç”¨æˆ·åœ¨ç‚¹å‡»è¾“å…¥æ¡†çš„æ—¶å€™æ•´ä¸ªèŠå¤©ç•Œé¢å¤šå¾€ä¸Šç§»åŠ¨å¤§æ¦‚ 40px çš„è·ç¦»ï¼Œä¸èƒ½å¿ã€‚</p>
<h3 id="MessagerKit-1"><a href="#MessagerKit-1" class="headerlink" title="MessagerKit"></a>MessagerKit</h3><p>å—¯ï¼Œæˆ‘åˆæ¢å›æ¥äº† ğŸ˜…ï¼Œæœ€ç»ˆå†³å®šè¿˜æ˜¯ç”¨å›ç¬¬ä¸€æ¬¡çš„åº“ã€‚æ¥æ¥å›å›å°†è¿‘ä¸‰å››å¤©çš„æ—¶é—´éƒ½åœ¨åˆ‡æ¢è¿™ä¸¤ä¸ª UI åº“ä¸Šï¼ŒåŸºæœ¬ä¸Šéƒ½æ˜¯å¿«å†™å®Œäº†æ‰å‘ç°æœ‰äº›å¥‡æ€ªçš„åœ°æ–¹ï¼Œç„¶åå…¨éƒ¨æ¨ç¿»å†é‡æ¥ã€‚</p>
<h2 id="æ¥å…¥èäº‘"><a href="#æ¥å…¥èäº‘" class="headerlink" title="æ¥å…¥èäº‘"></a>æ¥å…¥èäº‘</h2><p>é¦–å…ˆæŒ‰ç…§èäº‘çš„å®˜æ–¹æ–‡æ¡£è¿›è¡Œè´¦å·çš„æ³¨å†Œå’Œåº”ç”¨çš„åˆ›å»ºã€‚æ‹¿åˆ° <code>Appkey</code>ï¼Œé›†æˆ <code>RongCloudIM/IMLib</code> åˆ°å·¥ç¨‹ä¸­ã€‚</p>
<h3 id="ç™»å½•"><a href="#ç™»å½•" class="headerlink" title="ç™»å½•"></a>ç™»å½•</h3><p>å®˜æ–¹æ–‡æ¡£å¹¶ä¸æ¨èåœ¨å®¢æˆ·ç«¯ç”Ÿæˆ <code>token</code> è¿›è¡Œèäº‘ SDK çš„ç™»å½•ï¼Œå› ä¸ºç”Ÿæˆ <code>token</code> çš„è¿‡ç¨‹æ¶‰åŠåˆ°çš„ <code>AppSecret</code> çš„å›ºå®šï¼Œå¦‚æœ app è¢«åç¼–è¯‘åˆ™æœ‰æå¤§å¯èƒ½å¯¼è‡´æ³„æ¼ã€‚ä½†æ˜¯å¦‚æœä½ å¿ƒå¤Ÿå¤§æˆ–è€…åªæ˜¯åšä¸ª demo ç©ç©ï¼Œåœ¨å®¢æˆ·ç«¯æœ¬åœ°è¯·æ±‚ç”Ÿæˆ <code>token</code> ä¹Ÿä¸æ˜¯ä¸å¯ä»¥ï¼Œä»¥ä¸‹æ˜¯åŸºäºèäº‘ server python sdk çš„ <code>token</code> ç”Ÿæˆä»£ç ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@decorator.request_methon(<span class="params"><span class="string">&#x27;GET&#x27;</span></span>)</span></span><br><span class="line"><span class="meta">@decorator.request_check_args(<span class="params">[]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getRCToken</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="keyword">from</span> rongcloud <span class="keyword">import</span> RongCloud</span><br><span class="line"></span><br><span class="line">    uid = request.GET.get(<span class="string">&#x27;uid&#x27;</span>)</span><br><span class="line">    nick_name = request.GET.get(<span class="string">&#x27;nick_name&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    app_key = settings.RC_APP_KEY</span><br><span class="line">    app_secret = settings.RC_APP_SECRET</span><br><span class="line">    rcloud = RongCloud(app_key, app_secret)</span><br><span class="line"></span><br><span class="line">    r = rcloud.User.getToken(userId=uid,</span><br><span class="line">                             name=nick_name,</span><br><span class="line">                             portraitUri=<span class="string">&#x27;https://avatars0.githubusercontent.com/u/15074681?s=460&amp;v=4&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    r_json = <span class="built_in">eval</span>(<span class="built_in">str</span>(r.response.content, encoding=<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    <span class="keyword">if</span> r_json[<span class="string">&#x27;code&#x27;</span>] == <span class="number">200</span>:</span><br><span class="line">        json = &#123;</span><br><span class="line">            <span class="string">&#x27;token&#x27;</span>: r_json[<span class="string">&#x27;token&#x27;</span>]</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> utils.SuccessResponse(json, request)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        masLogger.log(request, <span class="number">2333</span>, <span class="built_in">str</span>(r.response.content, encoding=<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">        <span class="keyword">return</span> utils.ErrorResponse(<span class="number">2333</span>, <span class="string">&#x27;RCToken error&#x27;</span>, request)</span><br></pre></td></tr></table></figure>

<p>åœ¨å®¢æˆ·ç«¯ä¸Šè¿›è¡Œè¯·æ±‚ç”Ÿæˆ <code>token</code> çš„æ¥å£å³å¯</p>
<h3 id="å‘é€æ¶ˆæ¯"><a href="#å‘é€æ¶ˆæ¯" class="headerlink" title="å‘é€æ¶ˆæ¯"></a>å‘é€æ¶ˆæ¯</h3><p>å‘é€æ¶ˆæ¯ä¸»è¦æ˜¯ä½¿ç”¨å¦‚ä¸‹æ–¹æ³•ï¼š</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">- (RCMessage *)sendMessage:(RCConversationType)conversationType</span><br><span class="line">                  targetId:(<span class="built_in">NSString</span> *)targetId</span><br><span class="line">                   content:(RCMessageContent *)content</span><br><span class="line">               pushContent:(<span class="built_in">NSString</span> *)pushContent</span><br><span class="line">                  pushData:(<span class="built_in">NSString</span> *)pushData</span><br><span class="line">                   success:(<span class="type">void</span> (^)(<span class="type">long</span> messageId))successBlock</span><br><span class="line">                     error:(<span class="type">void</span> (^)(RCErrorCode nErrorCode, <span class="type">long</span> messageId))errorBlock;</span><br></pre></td></tr></table></figure>

<p>å…³äºè¯¥æ–¹æ³•çš„ä½¿ç”¨åœ¨æ³¨é‡Šä¸­å·²ç»å†™çš„å¾ˆæ˜ç™½ï¼Œæˆ‘ä»¬éœ€è¦åšçš„å°±æ˜¯æŠŠå®ƒè¿›è¡Œä¸€ä¸ªå°è£…ï¼Œä½¿å…¶å¯¹å¤–æ›´å¥½çš„ä½¿ç”¨ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// å‘é€æ–‡æœ¬æ¶ˆæ¯</span></span><br><span class="line"><span class="keyword">func</span> <span class="title function_">sendText</span>(<span class="params">textString</span>: <span class="type">String</span>,</span><br><span class="line">              <span class="params">userID</span>: <span class="type">String</span>,</span><br><span class="line">              <span class="params">complateHandler</span>: <span class="keyword">@escaping</span> ((<span class="type">Int</span>) -&gt; <span class="type">Void</span>),</span><br><span class="line">              <span class="params">failerHandler</span>: <span class="keyword">@escaping</span> ((<span class="type">RCErrorCode</span>) -&gt; <span class="type">Void</span>)) &#123;</span><br><span class="line">    <span class="keyword">let</span> text <span class="operator">=</span> <span class="type">RCTextMessage</span>(content: textString)</span><br><span class="line">    <span class="type">RCIMClient</span>.shared()<span class="operator">?</span>.sendMessage(.<span class="type">ConversationType_PRIVATE</span>,</span><br><span class="line">                                      targetId: userID,</span><br><span class="line">                                      content: text,</span><br><span class="line">                                      pushContent: <span class="literal">nil</span>,</span><br><span class="line">                                      pushData: <span class="literal">nil</span>,</span><br><span class="line">                                      success: &#123; (mesId) <span class="keyword">in</span></span><br><span class="line">                                        complateHandler(mesId)</span><br><span class="line">    &#125;, error: &#123; (errorCode, mesId) <span class="keyword">in</span></span><br><span class="line">        failerHandler(errorCode)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä»¥ä¸Šä¸ºå‘é€æ–‡æœ¬æ¶ˆæ¯çš„æ–¹æ³•ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨è°ƒç”¨è¯¥æ–¹æ³•ä¹‹å‰å¿…é¡»ç¡®å®šè¦æ¶ˆæ¯ä½“çš„ç±»å‹ç­‰å‰ç½®æ¡ä»¶ï¼Œå¿…é¡»å¾—å…ˆç¡®å®šè¦å‘é€çš„æ¶ˆæ¯ä½“ç±»å‹æ¥è°ƒç”¨ä¸åŒçš„æ–¹æ³•ï¼Œæ¯”å¦‚å›¾ç‰‡ã€è¯­éŸ³å’Œè§†é¢‘ç­‰ï¼ŒåŒ…æ‹¬è‡ªå®šä¹‰æ¶ˆæ¯ä½“ï¼Œåœ°å›¾ç­‰ã€‚</p>
<h3 id="æ¥æ”¶æ¶ˆæ¯"><a href="#æ¥æ”¶æ¶ˆæ¯" class="headerlink" title="æ¥æ”¶æ¶ˆæ¯"></a>æ¥æ”¶æ¶ˆæ¯</h3><p>å…³äºæ¶ˆæ¯çš„æ¥æ”¶ï¼Œèäº‘å¹¶æ²¡æœ‰é™åˆ¶æ¶ˆæ¯ç›‘å¬å™¨çš„ç±»å‹ï¼Œåªè¦ä½ æ˜¯ <code>NSObject</code> å­ç±»å°±å¯ä»¥å®ç°ä»£ç†æ–¹æ³•æ¥æ”¶æ¶ˆæ¯ã€‚æ‰€ä»¥ï¼Œæˆ‘æŠŠæ¶ˆæ¯æ¥æ”¶ç¨å¾®å°è£…äº†ä¸€ä¸‹ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extension</span> <span class="title class_">PJIM</span>: <span class="title class_">RCIMClientReceiveMessageDelegate</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">onReceived</span>(<span class="keyword">_</span> <span class="params">message</span>: <span class="type">RCMessage</span>!, <span class="params">left</span> <span class="params">nLeft</span>: <span class="type">Int32</span>, <span class="params">object</span>: <span class="keyword">Any</span><span class="operator">!</span>) &#123;</span><br><span class="line">        <span class="built_in">print</span>(message.objectName)</span><br><span class="line">        <span class="keyword">switch</span> message.objectName &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;RC:TxtMsg&quot;</span>:</span><br><span class="line">            <span class="keyword">let</span> text <span class="operator">=</span> message.content <span class="keyword">as!</span> <span class="type">RCTextMessage</span></span><br><span class="line">            <span class="keyword">let</span> m <span class="operator">=</span> <span class="type">Message</span>(type: .text,</span><br><span class="line">                            textContent: text.content,</span><br><span class="line">                            audioContent: <span class="literal">nil</span>,</span><br><span class="line">                            sendUserId: message.senderUserId,</span><br><span class="line">                            msgId: message.messageId,</span><br><span class="line">                            msgDirection: message.messageDirection,</span><br><span class="line">                            msgStatus: message.sentStatus,</span><br><span class="line">                            msgReceivedTime: message.receivedTime,</span><br><span class="line">                            msgSentTime: message.sentTime)</span><br><span class="line">            getMsg<span class="operator">?</span>(m)</span><br><span class="line">            <span class="built_in">print</span>(m.textContent<span class="operator">!</span>)</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;RCImageMessage&quot;</span>: <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">default</span>: <span class="keyword">break</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­ <code>Message</code> æ˜¯æˆ‘æ ¹æ®ä¸šåŠ¡è‡ªå»ºçš„ä¸€ä¸ªç»“æ„ä½“ï¼Œå› ä¸º <code>RCMessage</code> çš„å±æ€§å¤ªå¤šäº†ï¼Œå¾ˆå¤šéƒ½ç”¨ä¸åˆ°ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥é€‰æ‹©ä¸å°è£…ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extension</span> <span class="title class_">PJIM</span> &#123;</span><br><span class="line">    <span class="keyword">enum</span> <span class="title class_">MessageType</span> &#123;</span><br><span class="line">        <span class="keyword">case</span> text</span><br><span class="line">        <span class="keyword">case</span> audio</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Message</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> type: <span class="type">MessageType</span></span><br><span class="line">        <span class="keyword">var</span> textContent: <span class="type">String</span>?</span><br><span class="line">        <span class="keyword">var</span> audioContent: <span class="type">Data</span>?</span><br><span class="line">        <span class="keyword">var</span> sendUserId: <span class="type">String</span></span><br><span class="line">        <span class="keyword">var</span> msgId: <span class="type">Int</span></span><br><span class="line">        <span class="keyword">var</span> msgDirection: <span class="type">RCMessageDirection</span></span><br><span class="line">        <span class="keyword">var</span> msgStatus: <span class="type">RCSentStatus</span></span><br><span class="line">        <span class="keyword">var</span> msgReceivedTime: <span class="type">Int64</span></span><br><span class="line">        <span class="keyword">var</span> msgSentTime: <span class="type">Int64</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">MessageListCell</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> avatar: <span class="type">Int</span></span><br><span class="line">        <span class="keyword">var</span> nickName: <span class="type">String</span></span><br><span class="line">        <span class="keyword">var</span> uid: <span class="type">String</span></span><br><span class="line">        <span class="keyword">var</span> message: <span class="type">Message</span>?</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è‡³æ­¤ï¼Œæˆ‘ä»¬é€šè¿‡äº†ä¸¤ä¸ªæ–¹æ³•å°±å®Œæˆäº†æ¶ˆæ¯çš„å‘é€å’Œæ¥æ”¶ï½å¯ä»¥æ„‰å¿«çš„ç©è€ä¸€ç•ªäº†ï¼</p>
<h3 id="è·å–æ¶ˆæ¯åˆ—è¡¨"><a href="#è·å–æ¶ˆæ¯åˆ—è¡¨" class="headerlink" title="è·å–æ¶ˆæ¯åˆ—è¡¨"></a>è·å–æ¶ˆæ¯åˆ—è¡¨</h3><p>å¦‚æœä½ æ˜¯å…è´¹ç”¨æˆ·ï¼Œé‚£ä¹ˆä»èäº‘è·å–æ¶ˆæ¯åˆ—è¡¨åªæ˜¯æœ¬åœ°æ•°æ®ï¼Œå¦‚æœç”¨æˆ·æ›´æ¢äº†è®¾å¤‡ã€é‡è£…äº† app ç­‰éƒ½<strong>ä¼šå¯¼è‡´æ¶ˆæ¯åˆ—è¡¨çš„ä¸¢å¤±</strong>ï¼›å¦‚æœä½ æ˜¯æ”¶è´¹ç”¨æˆ·ï¼Œä»èäº‘æœåŠ¡å™¨ä¸Šæ‹‰å–åˆ°çš„æ¶ˆæ¯åˆ—è¡¨è²Œä¼¼<strong>åªæœ‰åŒºåŒºä¸ƒå¤©ï¼ˆå†é•¿ä¹Ÿæ˜¯å¤šå‡ å¤©è€Œå·²ï¼‰</strong>ï¼Œæ‰€ä»¥å¦‚æœå¯¹æ¶ˆæ¯åˆ—è¡¨æœ‰è¿½æ±‚çš„åŒå­¦éœ€è¦æ³¨æ„äº†ã€‚</p>
<p>æˆ‘çš„æ¶ˆæ¯åˆ—è¡¨è¿˜æ¶‰åŠåˆ°äº†ç”¨æˆ·ä¿¡æ¯çš„è·å–ï¼Œè¿™éƒ¨åˆ†æ˜¯å¼‚æ­¥è¯·æ±‚ï¼Œç»“åˆèäº‘çš„åŒæ­¥è·å–æœ¬åœ°æ¶ˆæ¯åˆ—è¡¨ï¼Œè¿™å°±å½¢æˆäº†ä¸€ä¸ªå¼‚æ­¥æ“ä½œä¿æŒé¡ºåºæ€§çš„é—®é¢˜ã€‚ä¸ºäº†åˆ°è¾¾â€œç®€æ´â€çš„æ“ä½œï¼Œæˆ‘åªä½¿ç”¨äº†â€œä¿¡å·é‡â€çš„æ–¹æ³•å®Œæˆã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// è·å–æœ¬åœ°ä¼šè¯åˆ—è¡¨</span></span><br><span class="line"><span class="keyword">func</span> <span class="title function_">getConversionList</span>(<span class="keyword">_</span> <span class="params">complateHandler</span>: <span class="keyword">@escaping</span> (([<span class="type">MessageListCell</span>]) -&gt; <span class="type">Void</span>)) &#123;</span><br><span class="line">    <span class="keyword">let</span> cTypes <span class="operator">=</span> [<span class="type">NSNumber</span>(value: <span class="type">RCConversationType</span>.<span class="type">ConversationType_PRIVATE</span>.rawValue)]</span><br><span class="line">    <span class="keyword">let</span> cList <span class="operator">=</span> <span class="type">RCIMClient</span>.shared()<span class="operator">?</span>.getConversationList(cTypes) <span class="keyword">as?</span> [<span class="type">RCConversation</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> msgListCells <span class="operator">=</span> [<span class="type">MessageListCell</span>]()</span><br><span class="line">    <span class="keyword">guard</span> cList <span class="operator">!=</span> <span class="literal">nil</span> <span class="keyword">else</span> &#123; <span class="keyword">return</span> complateHandler(msgListCells)&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> cList<span class="operator">?</span>.count <span class="operator">!=</span> <span class="number">0</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> cIndex <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> cList<span class="operator">!</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> currentMessage <span class="operator">=</span> <span class="type">RCMessage</span>(type: .<span class="type">ConversationType_PRIVATE</span>,</span><br><span class="line">                                            targetId: c.targetId,</span><br><span class="line">                                            direction: c.lastestMessageDirection,</span><br><span class="line">                                            messageId: c.lastestMessageId,</span><br><span class="line">                                            content: c.lastestMessage)</span><br><span class="line">            currentMessage<span class="operator">?</span>.sentTime <span class="operator">=</span> c.sentTime</span><br><span class="line">            currentMessage<span class="operator">?</span>.receivedTime <span class="operator">=</span> c.receivedTime</span><br><span class="line">            currentMessage<span class="operator">?</span>.senderUserId <span class="operator">=</span> c.senderUserId</span><br><span class="line">            currentMessage<span class="operator">?</span>.sentStatus <span class="operator">=</span> c.sentStatus</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> currentMessage <span class="operator">!=</span> <span class="literal">nil</span> &#123;</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">let</span> message <span class="operator">=</span> getMessage(with: currentMessage<span class="operator">!</span>)</span><br><span class="line">                <span class="keyword">if</span> message <span class="operator">==</span> <span class="literal">nil</span> &#123; <span class="keyword">break</span> &#125;</span><br><span class="line">                </span><br><span class="line">                <span class="comment">// è·å–ç”¨æˆ·ä¿¡æ¯ï¼Œå¯ä»¥æ›¿æ¢ä¸ºä½ çš„ï¼Œå¦‚æœä¸éœ€è¦è·å–ç”¨æˆ·ä¿¡æ¯ï¼Œå¯ä»¥åˆ é™¤</span></span><br><span class="line">                <span class="type">PJUser</span>.shared.details(details_uid: c.targetId,</span><br><span class="line">                                      getSelf: <span class="literal">false</span>,</span><br><span class="line">                                      completeHandler: &#123;</span><br><span class="line">                                        <span class="keyword">let</span> msgCell <span class="operator">=</span> <span class="type">MessageListCell</span>(avatar: <span class="variable">$0</span>.avatar<span class="operator">!</span>,</span><br><span class="line">                                                                      nickName: <span class="variable">$0</span>.nick_name<span class="operator">!</span>,</span><br><span class="line">                                                                      uid: <span class="variable">$0</span>.uid<span class="operator">!</span>,</span><br><span class="line">                                                                      message: message<span class="operator">!</span>)</span><br><span class="line">                                        msgListCells.append(msgCell)</span><br><span class="line">                                        </span><br><span class="line">                                        <span class="keyword">if</span> cIndex <span class="operator">==</span> cList<span class="operator">!</span>.count <span class="operator">-</span> <span class="number">1</span> &#123;</span><br><span class="line">                                            <span class="keyword">var</span> finalCells <span class="operator">=</span> [<span class="type">MessageListCell</span>]()</span><br><span class="line">                                            <span class="keyword">for</span> cell <span class="keyword">in</span> cList<span class="operator">!</span> &#123;</span><br><span class="line">                                                <span class="keyword">_</span> <span class="operator">=</span> msgListCells.filter(&#123;</span><br><span class="line">                                                    <span class="keyword">if</span> <span class="variable">$0</span>.uid <span class="operator">==</span> cell.targetId &#123;</span><br><span class="line">                                                        finalCells.append(<span class="variable">$0</span>)</span><br><span class="line">                                                        <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">                                                    &#125;; <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">                                                &#125;)</span><br><span class="line">                                            &#125;</span><br><span class="line">                                            </span><br><span class="line">                                            complateHandler(finalCells)</span><br><span class="line">                                        &#125;</span><br><span class="line">                                    </span><br><span class="line">                                        cIndex <span class="operator">+=</span> <span class="number">1</span></span><br><span class="line">                &#125;) &#123; <span class="built_in">print</span>(<span class="variable">$0</span>.errorMsg) &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        complateHandler(msgListCells)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="PJIM"><a href="#PJIM" class="headerlink" title="PJIM"></a>PJIM</h3><p>ç»“åˆèäº‘å½¢æˆä¸€ä¸ªç®€å•æ•°æ®æœåŠ¡å°±å†™å¥½äº†ï¼Œé€šè¿‡å•ä¾‹åœ¨ä»»ä½•ä½ æƒ³è¦è¿›è¡Œæ¶ˆæ¯çš„å‘é€å’Œæ¥æ”¶ï¼Œå®Œæ•´ä»£ç å¦‚ä¸‹ã€‚å…¶ä¸­æœ‰ä¸€éƒ¨åˆ†æ˜¯ä¸šåŠ¡è€¦åˆè¾ƒä¸ºä¸¥é‡çš„æ–¹æ³•ä¸æ–¹ä¾¿å±•å¼€ï¼Œçœ‹ç€æ›¿æ¢å³å¯ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  PJIM.swift</span></span><br><span class="line"><span class="comment">//  PIGPEN</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by PJHubs on 2019/4/9.</span></span><br><span class="line"><span class="comment">//  Copyright Â© 2019 PJHubs. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> Foundation</span><br><span class="line"></span><br><span class="line"><span class="keyword">@objc</span> <span class="keyword">class</span> <span class="title class_">PJIM</span>: <span class="title class_">NSObject</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> getMsg: ((<span class="type">Message</span>) -&gt; <span class="type">Void</span>)<span class="operator">?</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">let</span> instance <span class="operator">=</span> <span class="type">PJIM</span>()</span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">func</span> <span class="title class_">share</span>() -&gt; <span class="title class_">PJIM</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> instance</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">init</span>() &#123;</span><br><span class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>()</span><br><span class="line">        <span class="type">RCIMClient</span>.shared()<span class="operator">?</span>.setReceiveMessageDelegate(<span class="keyword">self</span>, object: <span class="literal">nil</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/// å‘é€æ–‡æœ¬æ¶ˆæ¯</span></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">sendText</span>(<span class="params">textString</span>: <span class="type">String</span>,</span><br><span class="line">                  <span class="params">userID</span>: <span class="type">String</span>,</span><br><span class="line">                  <span class="params">complateHandler</span>: <span class="keyword">@escaping</span> ((<span class="type">Int</span>) -&gt; <span class="type">Void</span>),</span><br><span class="line">                  <span class="params">failerHandler</span>: <span class="keyword">@escaping</span> ((<span class="type">RCErrorCode</span>) -&gt; <span class="type">Void</span>)) &#123;</span><br><span class="line">        <span class="keyword">let</span> text <span class="operator">=</span> <span class="type">RCTextMessage</span>(content: textString)</span><br><span class="line">        <span class="type">RCIMClient</span>.shared()<span class="operator">?</span>.sendMessage(.<span class="type">ConversationType_PRIVATE</span>,</span><br><span class="line">                                         targetId: userID,</span><br><span class="line">                                         content: text,</span><br><span class="line">                                         pushContent: <span class="literal">nil</span>,</span><br><span class="line">                                         pushData: <span class="literal">nil</span>,</span><br><span class="line">                                         success: &#123; (mesId) <span class="keyword">in</span></span><br><span class="line">                                            complateHandler(mesId)</span><br><span class="line">        &#125;, error: &#123; (errorCode, mesId) <span class="keyword">in</span></span><br><span class="line">            failerHandler(errorCode)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/// è·å–æœ¬åœ°ä¼šè¯åˆ—è¡¨</span></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">getConversionList</span>(<span class="keyword">_</span> <span class="params">complateHandler</span>: <span class="keyword">@escaping</span> (([<span class="type">MessageListCell</span>]) -&gt; <span class="type">Void</span>)) &#123;</span><br><span class="line">        <span class="keyword">let</span> cTypes <span class="operator">=</span> [<span class="type">NSNumber</span>(value: <span class="type">RCConversationType</span>.<span class="type">ConversationType_PRIVATE</span>.rawValue)]</span><br><span class="line">        <span class="keyword">let</span> cList <span class="operator">=</span> <span class="type">RCIMClient</span>.shared()<span class="operator">?</span>.getConversationList(cTypes) <span class="keyword">as?</span> [<span class="type">RCConversation</span>]</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">var</span> msgListCells <span class="operator">=</span> [<span class="type">MessageListCell</span>]()</span><br><span class="line">        <span class="keyword">guard</span> cList <span class="operator">!=</span> <span class="literal">nil</span> <span class="keyword">else</span> &#123; <span class="keyword">return</span> complateHandler(msgListCells)&#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> cList<span class="operator">?</span>.count <span class="operator">!=</span> <span class="number">0</span> &#123;</span><br><span class="line">            <span class="keyword">var</span> cIndex <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">            <span class="keyword">for</span> c <span class="keyword">in</span> cList<span class="operator">!</span> &#123;</span><br><span class="line">                <span class="keyword">let</span> currentMessage <span class="operator">=</span> <span class="type">RCMessage</span>(type: .<span class="type">ConversationType_PRIVATE</span>,</span><br><span class="line">                                               targetId: c.targetId,</span><br><span class="line">                                               direction: c.lastestMessageDirection,</span><br><span class="line">                                               messageId: c.lastestMessageId,</span><br><span class="line">                                               content: c.lastestMessage)</span><br><span class="line">                currentMessage<span class="operator">?</span>.sentTime <span class="operator">=</span> c.sentTime</span><br><span class="line">                currentMessage<span class="operator">?</span>.receivedTime <span class="operator">=</span> c.receivedTime</span><br><span class="line">                currentMessage<span class="operator">?</span>.senderUserId <span class="operator">=</span> c.senderUserId</span><br><span class="line">                currentMessage<span class="operator">?</span>.sentStatus <span class="operator">=</span> c.sentStatus</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span> currentMessage <span class="operator">!=</span> <span class="literal">nil</span> &#123;</span><br><span class="line">                    </span><br><span class="line">                    <span class="keyword">let</span> message <span class="operator">=</span> getMessage(with: currentMessage<span class="operator">!</span>)</span><br><span class="line">                    <span class="keyword">if</span> message <span class="operator">==</span> <span class="literal">nil</span> &#123; <span class="keyword">break</span> &#125;</span><br><span class="line">                    </span><br><span class="line">                    <span class="type">PJUser</span>.shared.details(details_uid: c.targetId,</span><br><span class="line">                                          getSelf: <span class="literal">false</span>,</span><br><span class="line">                                          completeHandler: &#123;</span><br><span class="line">                                            <span class="keyword">let</span> msgCell <span class="operator">=</span> <span class="type">MessageListCell</span>(avatar: <span class="variable">$0</span>.avatar<span class="operator">!</span>,</span><br><span class="line">                                                                          nickName: <span class="variable">$0</span>.nick_name<span class="operator">!</span>,</span><br><span class="line">                                                                          uid: <span class="variable">$0</span>.uid<span class="operator">!</span>,</span><br><span class="line">                                                                          message: message<span class="operator">!</span>)</span><br><span class="line">                                            msgListCells.append(msgCell)</span><br><span class="line">                                            </span><br><span class="line">                                            <span class="keyword">if</span> cIndex <span class="operator">==</span> cList<span class="operator">!</span>.count <span class="operator">-</span> <span class="number">1</span> &#123;</span><br><span class="line">                                                <span class="keyword">var</span> finalCells <span class="operator">=</span> [<span class="type">MessageListCell</span>]()</span><br><span class="line">                                                <span class="keyword">for</span> cell <span class="keyword">in</span> cList<span class="operator">!</span> &#123;</span><br><span class="line">                                                    <span class="keyword">_</span> <span class="operator">=</span> msgListCells.filter(&#123;</span><br><span class="line">                                                        <span class="keyword">if</span> <span class="variable">$0</span>.uid <span class="operator">==</span> cell.targetId &#123;</span><br><span class="line">                                                            finalCells.append(<span class="variable">$0</span>)</span><br><span class="line">                                                            <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">                                                        &#125;; <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">                                                    &#125;)</span><br><span class="line">                                                &#125;</span><br><span class="line">                                                </span><br><span class="line">                                                complateHandler(finalCells)</span><br><span class="line">                                            &#125;</span><br><span class="line">                                        </span><br><span class="line">                                            cIndex <span class="operator">+=</span> <span class="number">1</span></span><br><span class="line">                    &#125;) &#123; <span class="built_in">print</span>(<span class="variable">$0</span>.errorMsg) &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            complateHandler(msgListCells)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">func</span> <span class="title function_">getMessage</span>(<span class="params">with</span> <span class="params">rcMessage</span>: <span class="type">RCMessage</span>) -&gt; <span class="type">Message</span>? &#123;</span><br><span class="line">        <span class="keyword">switch</span> rcMessage.objectName &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;RC:TxtMsg&quot;</span>:</span><br><span class="line">                <span class="keyword">let</span> text <span class="operator">=</span> rcMessage.content <span class="keyword">as!</span> <span class="type">RCTextMessage</span></span><br><span class="line">                <span class="keyword">let</span> m <span class="operator">=</span> <span class="type">Message</span>(type: .text,</span><br><span class="line">                                textContent: text.content,</span><br><span class="line">                                audioContent: <span class="literal">nil</span>,</span><br><span class="line">                                sendUserId: rcMessage.senderUserId,</span><br><span class="line">                                msgId: rcMessage.messageId,</span><br><span class="line">                                msgDirection: rcMessage.messageDirection,</span><br><span class="line">                                msgStatus: rcMessage.sentStatus,</span><br><span class="line">                                msgReceivedTime: rcMessage.receivedTime,</span><br><span class="line">                                msgSentTime: rcMessage.sentTime)</span><br><span class="line">                <span class="keyword">return</span> m</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;RCImageMessage&quot;</span>: <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">default</span>: <span class="keyword">break</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">PJIM</span>: <span class="title class_">RCIMClientReceiveMessageDelegate</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">onReceived</span>(<span class="keyword">_</span> <span class="params">message</span>: <span class="type">RCMessage</span>!, <span class="params">left</span> <span class="params">nLeft</span>: <span class="type">Int32</span>, <span class="params">object</span>: <span class="keyword">Any</span><span class="operator">!</span>) &#123;</span><br><span class="line">        <span class="built_in">print</span>(message.objectName)</span><br><span class="line">        <span class="keyword">switch</span> message.objectName &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;RC:TxtMsg&quot;</span>:</span><br><span class="line">            <span class="keyword">let</span> text <span class="operator">=</span> message.content <span class="keyword">as!</span> <span class="type">RCTextMessage</span></span><br><span class="line">            <span class="keyword">let</span> m <span class="operator">=</span> <span class="type">Message</span>(type: .text,</span><br><span class="line">                            textContent: text.content,</span><br><span class="line">                            audioContent: <span class="literal">nil</span>,</span><br><span class="line">                            sendUserId: message.senderUserId,</span><br><span class="line">                            msgId: message.messageId,</span><br><span class="line">                            msgDirection: message.messageDirection,</span><br><span class="line">                            msgStatus: message.sentStatus,</span><br><span class="line">                            msgReceivedTime: message.receivedTime,</span><br><span class="line">                            msgSentTime: message.sentTime)</span><br><span class="line">            getMsg<span class="operator">?</span>(m)</span><br><span class="line">            <span class="built_in">print</span>(m.textContent<span class="operator">!</span>)</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;RCImageMessage&quot;</span>: <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">default</span>: <span class="keyword">break</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">PJIM</span> &#123;</span><br><span class="line">    <span class="keyword">enum</span> <span class="title class_">MessageType</span> &#123;</span><br><span class="line">        <span class="keyword">case</span> text</span><br><span class="line">        <span class="keyword">case</span> audio</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Message</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> type: <span class="type">MessageType</span></span><br><span class="line">        <span class="keyword">var</span> textContent: <span class="type">String</span>?</span><br><span class="line">        <span class="keyword">var</span> audioContent: <span class="type">Data</span>?</span><br><span class="line">        <span class="keyword">var</span> sendUserId: <span class="type">String</span></span><br><span class="line">        <span class="keyword">var</span> msgId: <span class="type">Int</span></span><br><span class="line">        <span class="keyword">var</span> msgDirection: <span class="type">RCMessageDirection</span></span><br><span class="line">        <span class="keyword">var</span> msgStatus: <span class="type">RCSentStatus</span></span><br><span class="line">        <span class="keyword">var</span> msgReceivedTime: <span class="type">Int64</span></span><br><span class="line">        <span class="keyword">var</span> msgSentTime: <span class="type">Int64</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">MessageListCell</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> avatar: <span class="type">Int</span></span><br><span class="line">        <span class="keyword">var</span> nickName: <span class="type">String</span></span><br><span class="line">        <span class="keyword">var</span> uid: <span class="type">String</span></span><br><span class="line">        <span class="keyword">var</span> message: <span class="type">Message</span>?</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="UI"><a href="#UI" class="headerlink" title="UI"></a>UI</h2><p>ç»è¿‡ä¹‹å‰çš„ä¸€ç•ªè°ƒæ•´ï¼Œå³æ—¶èŠå¤©çš„æ•°æ®æºéƒ½å‡†å¤‡å¥½äº†ï¼Œæ¥ä¸‹æ¥å°±æ˜¯è¦ç”»ç•Œé¢äº†ã€‚å…³äº UI åº“çš„é€‰æ‹©ä¸Šæ–‡å·²ç»è¯´æ˜ç»è¿‡äº†å‡ ç•ªæŠ˜è…¾åï¼Œæœ€ç»ˆçš„é€‰æ‹©æ˜¯ <a target="_blank" rel="noopener" href="https://github.com/steve228uk/MessengerKit">MessengerKit</a>ã€‚å› ä¸º UI å®ç°éƒ½å¾ˆæ™®é€šï¼Œæ²¡ä»€ä¹ˆå¯ä»¥åšæ‹“å±•çš„åœ°æ–¹ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›æˆ‘ä»»ä½•å€¼å¾—å…³æ³¨çš„åœ°æ–¹ï¼š</p>
<h3 id="ViewModel"><a href="#ViewModel" class="headerlink" title="ViewModel"></a>ViewModel</h3><p>èäº‘æä¾›çš„ <code>RCMessage</code> ç±»ç»“æ„å’Œ <code>MessengerKit</code> æ‰€è¦æ±‚çš„æ•°æ®ç±»å‹ä¸ä¸€æ ·ï¼Œéœ€è¦æˆ‘ä»¬å•ç‹¬é’ˆå¯¹ <code>MessengerKit</code> åšä¸€ä¸ª <code>ViewModel</code> å–‚é£Ÿã€‚</p>
<h3 id="å‘é€è€…å’Œæ¥æ”¶è€…"><a href="#å‘é€è€…å’Œæ¥æ”¶è€…" class="headerlink" title="å‘é€è€…å’Œæ¥æ”¶è€…"></a>å‘é€è€…å’Œæ¥æ”¶è€…</h3><p><code>MessengerKit</code> èŠå¤©æ°”æ³¡çš„åˆ‡æ¢æ˜¯æ ¹æ®â€œå‘é€è€…â€å’Œâ€œæ¥æ”¶è€…â€çš„ <code>id</code> è¿›è¡Œçš„ï¼Œæˆ‘ä»¬éœ€è¦å¤„ç†å¥½ä»èäº‘æ‹‰å–è¿‡æ¥çš„æ¶ˆæ¯åˆ—è¡¨ï¼Œæ ¹æ®â€œå‘é€è€…â€ <code>id</code> å’Œâ€œæ¥å—è€…â€ <code>id</code>ï¼ˆä¹Ÿå³ <code>targetId</code>ï¼‰è¿›è¡Œåˆ†å‰²ä¸ºä¸åŒçš„ <code>section</code>ï¼Œä»¥ä¸‹æ˜¯æˆ‘çš„å¤„ç†è¿‡ç¨‹ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">func</span> <span class="title function_">didSetMessageCell</span>() &#123;</span><br><span class="line">  <span class="comment">// å¦‚æœæœ‰æœªè¯»æ¶ˆæ¯æ•°ï¼Œè¿›å…¥èŠå¤©åå°±å…¨éƒ¨å·²è¯»</span></span><br><span class="line">  <span class="keyword">let</span> badge <span class="operator">=</span> <span class="type">RCIMClient</span>.shared()<span class="operator">!</span>.getUnreadCount(.<span class="type">ConversationType_PRIVATE</span>, targetId: messageCell<span class="operator">!</span>.uid)</span><br><span class="line">  <span class="keyword">if</span> (badge <span class="operator">!=</span> <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="type">RCIMClient</span>.shared()<span class="operator">!</span>.clearMessagesUnreadStatus(.<span class="type">ConversationType_PRIVATE</span>, targetId: messageCell<span class="operator">!</span>.uid)</span><br><span class="line">      <span class="type">UIApplication</span>.shared.applicationIconBadgeNumber <span class="operator">-=</span> <span class="type">Int</span>(badge)</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  titleString <span class="operator">=</span> messageCell<span class="operator">!</span>.nickName</span><br><span class="line">  friendUser <span class="operator">=</span> <span class="type">ChatUser</span>(displayName: messageCell<span class="operator">!</span>.nickName,</span><br><span class="line">                        avatar: <span class="type">UIImage</span>(named: <span class="string">&quot;<span class="subst">\(messageCell<span class="operator">!</span>.avatar)</span>&quot;</span>),</span><br><span class="line">                        isSender: <span class="literal">false</span>)</span><br><span class="line">  meUser <span class="operator">=</span> <span class="type">ChatUser</span>(displayName: <span class="type">PJUser</span>.shared.userModel.nick_name<span class="operator">!</span>,</span><br><span class="line">                    avatar: <span class="type">UIImage</span>(named: <span class="string">&quot;<span class="subst">\(PJUser.shared.userModel.avatar<span class="operator">!</span>)</span>&quot;</span>),</span><br><span class="line">                        isSender: <span class="literal">true</span>)</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">func</span> <span class="title function_">update</span>(<span class="keyword">_</span> <span class="params">ms</span>: [<span class="type">RCMessage</span>]) &#123;</span><br><span class="line">      <span class="keyword">var</span> m_index <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">      <span class="keyword">var</span> tempMsgs <span class="operator">=</span> [<span class="type">MSGMessage</span>]()</span><br><span class="line">      <span class="keyword">var</span> tempMsgUserId <span class="operator">=</span> messageCell<span class="operator">?</span>.uid</span><br><span class="line">      messages.append(tempMsgs)</span><br><span class="line">      </span><br><span class="line">      <span class="comment">// ä¾¿åˆ©æ‰€æœ‰æ¶ˆæ¯ï¼ŒæŒ‰ç…§ sendId å’Œ targetId è¿›è¡Œåˆ†ç¦»</span></span><br><span class="line">      <span class="keyword">for</span> m <span class="keyword">in</span> ms &#123;</span><br><span class="line">          <span class="keyword">let</span> text <span class="operator">=</span> m.content <span class="keyword">as!</span> <span class="type">RCTextMessage</span></span><br><span class="line">          <span class="keyword">if</span> tempMsgUserId <span class="operator">!=</span> m.senderUserId &#123;</span><br><span class="line">              tempMsgs.removeAll()</span><br><span class="line">              messages.append(tempMsgs)</span><br><span class="line">              m_index <span class="operator">+=</span> <span class="number">1</span></span><br><span class="line">              tempMsgUserId <span class="operator">=</span> m.senderUserId</span><br><span class="line">          &#125;</span><br><span class="line">          </span><br><span class="line">          <span class="keyword">let</span> c_m: <span class="type">MSGMessage</span>?</span><br><span class="line">          <span class="keyword">if</span> m.senderUserId <span class="operator">!=</span> <span class="type">PJUser</span>.shared.userModel.uid<span class="operator">!</span> &#123;</span><br><span class="line">              c_m <span class="operator">=</span> <span class="type">MSGMessage</span>(id: m.messageId,</span><br><span class="line">                                body: .text(text.content),</span><br><span class="line">                                user: friendUser<span class="operator">!</span>,</span><br><span class="line">                                sentAt: <span class="type">Date</span>(timeIntervalSince1970: <span class="type">TimeInterval</span>(m.sentTime)))</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">              c_m <span class="operator">=</span> <span class="type">MSGMessage</span>(id: m.messageId,</span><br><span class="line">                                body: .text(text.content),</span><br><span class="line">                                user: meUser<span class="operator">!</span>,</span><br><span class="line">                                sentAt: <span class="type">Date</span>(timeIntervalSince1970: <span class="type">TimeInterval</span>(m.sentTime)))</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="comment">// è®¾ç½®æ¶ˆæ¯å·²è¯»çŠ¶æ€</span></span><br><span class="line">          <span class="type">RCIMClient</span>.shared()<span class="operator">?</span>.setMessageSentStatus(m.messageId, sentStatus: .<span class="type">SentStatus_READ</span>)</span><br><span class="line">          </span><br><span class="line">          tempMsgs.insert(c_m<span class="operator">!</span>, at: <span class="number">0</span>)</span><br><span class="line">          messages.insert(tempMsgs, at: m_index)</span><br><span class="line">          messages.remove(at: m_index <span class="operator">+</span> <span class="number">1</span>)</span><br><span class="line">      &#125;</span><br><span class="line">      </span><br><span class="line">      messages.reverse()</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">let</span> ms <span class="operator">=</span> <span class="type">RCIMClient</span>.shared()<span class="operator">?</span>.getLatestMessages(.<span class="type">ConversationType_PRIVATE</span>, targetId: messageCell<span class="operator">?</span>.uid, count: <span class="number">30</span>) <span class="keyword">as?</span> [<span class="type">RCMessage</span>]</span><br><span class="line">  <span class="comment">// å¦‚æœæœ¬åœ°æ— æ¶ˆæ¯ï¼Œä»èäº‘æœåŠ¡å™¨ä¸Šæ‹‰å–</span></span><br><span class="line">  <span class="keyword">if</span> ms <span class="operator">!=</span> <span class="literal">nil</span> &#123;</span><br><span class="line">      update(ms<span class="operator">!</span>)</span><br><span class="line">      <span class="type">DispatchQueue</span>.main.async &#123;</span><br><span class="line">          <span class="comment">// reloadData æ—¶ä¸»çº¿ç¨‹è¢«å ç”¨ï¼ŒscrollToBottom ç­‰å¾…ï¼ŒreloadData å®Œæˆåï¼Œå†æ‰§è¡Œ scrollToBottom</span></span><br><span class="line">          <span class="keyword">self</span>.collectionView.reloadData()</span><br><span class="line">          <span class="type">DispatchQueue</span>.main.async &#123;</span><br><span class="line">              <span class="keyword">self</span>.collectionView.scrollToBottom(animated: <span class="literal">false</span>)</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// <span class="doctag">TODO:</span> è¿™éƒ¨åˆ†æœ‰é—®é¢˜ï¼Œéœ€è¦äº¤é’±æ‰èƒ½æ‹‰å–åˆ°æœåŠ¡å™¨ä¸Šçš„å†å²æ¶ˆæ¯</span></span><br><span class="line">      <span class="type">RCIMClient</span>.shared()<span class="operator">?</span>.getRemoteHistoryMessages(.<span class="type">ConversationType_PRIVATE</span>, targetId: <span class="type">PJUser</span>.shared.userModel.uid<span class="operator">!</span>, recordTime: <span class="number">0</span>, count: <span class="number">20</span>, success: &#123; (messages: [<span class="type">RCMessage</span>]) <span class="keyword">in</span></span><br><span class="line">              update(messages)</span><br><span class="line">          &#125; <span class="keyword">as?</span> ([<span class="keyword">Any</span>]<span class="operator">?</span>) -&gt; <span class="type">Void</span>, error: &#123; (errorCode) <span class="keyword">in</span></span><br><span class="line">              <span class="built_in">print</span>(errorCode.rawValue)</span><br><span class="line">      &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="æ¶ˆæ¯æ¨é€"><a href="#æ¶ˆæ¯æ¨é€" class="headerlink" title="æ¶ˆæ¯æ¨é€"></a>æ¶ˆæ¯æ¨é€</h2><p>è¿™éƒ¨åˆ†èäº‘æ–‡æ¡£å†™å¾—å¾ˆå¥½äº†ï½è®°å¾—åœ¨ Xcode ä¸­æŠŠ <code>Background Modes</code> çš„â€œè¿œç¨‹æ¨é€â€æ‰“å¼€ã€‚Â·</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>ä»¥ä¸Šæ˜¯æˆ‘å®Œæˆäº†ä¸€æœŸ IM è¿‡ç¨‹ä¸­çš„æ€è€ƒå’Œæ€»ç»“ï¼Œè§£å†³é—®é¢˜çš„æ–¹æ³•è¿˜æœ‰äº›è®¸ä¸è¶³ï¼Œå¸å–äº†ä¹‹å‰çš„åšå…¶å®ƒäº§å“çš„æ•™è®­ï¼Œæœ¬æ¬¡ä¸¥æ ¼éµå¾ª â€œMVPâ€ çš„å¼€å‘æµç¨‹ï¼Œå°æ­¥å¿«è·‘ï¼Œä¸€æœŸå·¥ä½œä¸»è¦æ˜¯å…ˆè·‘èµ·æ¥ï¼Œè®©å…¶å®ƒå°ä¼™ä¼´èŠèµ·æ¥ã€‚</p>
</div><div class="tags"><a href="/tags/iOS/"><i class="fa fa-tag"></i>iOS</a><a href="/tags/%E6%90%9E%E4%BA%8B%E6%83%85%E7%B3%BB%E5%88%97/"><i class="fa fa-tag"></i>æäº‹æƒ…ç³»åˆ—</a><a href="/tags/%E5%8D%B3%E6%97%B6%E9%80%9A%E8%AE%AF/"><i class="fa fa-tag"></i>å³æ—¶é€šè®¯</a></div><div class="post-nav"><a class="pre" href="/2019/05/04/vapor01/">æäº‹æƒ…ä¹‹ Vapor åˆæ¢</a><a class="next" href="/2019/04/18/mylearnroadmap/">æˆ‘çš„å¤§å­¦â€”â€”WWDC Scholarship &amp; å‡†å¤‡å·¥ä½œ</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> æ ‡ç­¾</i></div><div class="tagcloud"><a href="/tags/%E6%80%BB%E7%BB%93/" style="font-size: 15px;">æ€»ç»“</a> <a href="/tags/iOS/" style="font-size: 15px;">iOS</a> <a href="/tags/%E6%AF%94%E8%B5%9B/" style="font-size: 15px;">æ¯”èµ›</a> <a href="/tags/Cocos/" style="font-size: 15px;">Cocos</a> <a href="/tags/%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91/" style="font-size: 15px;">æ¸¸æˆå¼€å‘</a> <a href="/tags/DiDi/" style="font-size: 15px;">DiDi</a> <a href="/tags/internship/" style="font-size: 15px;">internship</a> <a href="/tags/Flutter/" style="font-size: 15px;">Flutter</a> <a href="/tags/%E8%B7%A8%E5%B9%B3%E5%8F%B0/" style="font-size: 15px;">è·¨å¹³å°</a> <a href="/tags/Audio/" style="font-size: 15px;">Audio</a> <a href="/tags/Ping/" style="font-size: 15px;">Ping</a> <a href="/tags/%E5%BC%B9%E5%B9%95/" style="font-size: 15px;">å¼¹å¹•</a> <a href="/tags/%E9%A1%B5%E9%9D%A2%E4%BC%A0%E5%80%BC/" style="font-size: 15px;">é¡µé¢ä¼ å€¼</a> <a href="/tags/HUD/" style="font-size: 15px;">HUD</a> <a href="/tags/Swift/" style="font-size: 15px;">Swift</a> <a href="/tags/%E5%BC%80%E6%BA%90/" style="font-size: 15px;">å¼€æº</a> <a href="/tags/%E9%A1%B9%E7%9B%AE/" style="font-size: 15px;">é¡¹ç›®</a> <a href="/tags/PhotosKit/" style="font-size: 15px;">PhotosKit</a> <a href="/tags/React-Native/" style="font-size: 15px;">React-Native</a> <a href="/tags/swift/" style="font-size: 15px;">swift</a> <a href="/tags/Weex/" style="font-size: 15px;">Weex</a> <a href="/tags/Apple/" style="font-size: 15px;">Apple</a> <a href="/tags/%E6%84%9F%E6%83%B3/" style="font-size: 15px;">æ„Ÿæƒ³</a> <a href="/tags/%E5%8D%9A%E5%AE%A2/" style="font-size: 15px;">åšå®¢</a> <a href="/tags/%E4%BA%91/" style="font-size: 15px;">äº‘</a> <a href="/tags/%E9%9A%8F%E6%83%B3/" style="font-size: 15px;">éšæƒ³</a> <a href="/tags/%E5%AD%97%E8%8A%82%E8%B7%B3%E5%8A%A8/" style="font-size: 15px;">å­—èŠ‚è·³åŠ¨</a> <a href="/tags/%E6%9C%88%E5%BA%A6%E6%80%BB%E7%BB%93/" style="font-size: 15px;">æœˆåº¦æ€»ç»“</a> <a href="/tags/%E9%9A%8F%E7%AC%94/" style="font-size: 15px;">éšç¬”</a> <a href="/tags/CMake/" style="font-size: 15px;">CMake</a> <a href="/tags/makefile/" style="font-size: 15px;">makefile</a> <a href="/tags/%E7%BC%96%E8%AF%91/" style="font-size: 15px;">ç¼–è¯‘</a> <a href="/tags/CodeLab/" style="font-size: 15px;">CodeLab</a> <a href="/tags/%E5%B0%91%E5%84%BF%E7%BC%96%E7%A8%8B/" style="font-size: 15px;">å°‘å„¿ç¼–ç¨‹</a> <a href="/tags/%E6%88%91%E7%9A%84%E5%A4%A7%E5%AD%A6/" style="font-size: 15px;">æˆ‘çš„å¤§å­¦</a> <a href="/tags/%E5%9B%9E%E5%BF%86%E5%BD%95/" style="font-size: 15px;">å›å¿†å½•</a> <a href="/tags/crash/" style="font-size: 15px;">crash</a> <a href="/tags/%E9%AA%91%E8%A1%8C/" style="font-size: 15px;">éª‘è¡Œ</a> <a href="/tags/%E8%87%AA%E8%A1%8C%E8%BD%A6/" style="font-size: 15px;">è‡ªè¡Œè½¦</a> <a href="/tags/fcc/" style="font-size: 15px;">fcc</a> <a href="/tags/%E5%88%86%E4%BA%AB/" style="font-size: 15px;">åˆ†äº«</a> <a href="/tags/%E6%B8%B8%E6%88%8F/" style="font-size: 15px;">æ¸¸æˆ</a> <a href="/tags/ifLab/" style="font-size: 15px;">ifLab</a> <a href="/tags/%E6%8A%80%E6%9C%AF/" style="font-size: 15px;">æŠ€æœ¯</a> <a href="/tags/%E5%BB%BA%E7%AB%99/" style="font-size: 15px;">å»ºç«™</a> <a href="/tags/%E9%9D%A2%E8%AF%95/" style="font-size: 15px;">é¢è¯•</a> <a href="/tags/%E7%A7%9F%E6%88%BF/" style="font-size: 15px;">ç§Ÿæˆ¿</a> <a href="/tags/iBistu/" style="font-size: 15px;">iBistu</a> <a href="/tags/macOS/" style="font-size: 15px;">macOS</a> <a href="/tags/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/" style="font-size: 15px;">ç¼–è¯‘åŸç†</a> <a href="/tags/%E7%9D%A1%E9%AD%94/" style="font-size: 15px;">ç¡é­”</a> <a href="/tags/Netflix/" style="font-size: 15px;">Netflix</a> <a href="/tags/%E6%91%84%E5%BD%B1/" style="font-size: 15px;">æ‘„å½±</a> <a href="/tags/%E4%BD%9C%E5%93%81/" style="font-size: 15px;">ä½œå“</a> <a href="/tags/%E5%BC%80%E5%8F%91%E6%97%A5%E5%BF%97/" style="font-size: 15px;">å¼€å‘æ—¥å¿—</a> <a href="/tags/App/" style="font-size: 15px;">App</a> <a href="/tags/%E4%BA%A7%E5%93%81%E6%80%9D%E8%80%83/" style="font-size: 15px;">äº§å“æ€è€ƒ</a> <a href="/tags/Playground/" style="font-size: 15px;">Playground</a> <a href="/tags/%E5%B7%A5%E4%BD%9C/" style="font-size: 15px;">å·¥ä½œ</a> <a href="/tags/SwiftUI/" style="font-size: 15px;">SwiftUI</a> <a href="/tags/%E5%BD%B1%E8%A7%86%E5%89%A7/" style="font-size: 15px;">å½±è§†å‰§</a> <a href="/tags/WWDC/" style="font-size: 15px;">WWDC</a> <a href="/tags/%E5%AD%97%E8%8A%82/" style="font-size: 15px;">å­—èŠ‚</a> <a href="/tags/%E8%B7%91%E6%AD%A5/" style="font-size: 15px;">è·‘æ­¥</a> <a href="/tags/%E9%A9%AC%E6%8B%89%E6%9D%BE/" style="font-size: 15px;">é©¬æ‹‰æ¾</a> <a href="/tags/%E8%BF%90%E5%8A%A8/" style="font-size: 15px;">è¿åŠ¨</a> <a href="/tags/%E8%B6%8A%E9%87%8E%E8%B7%91/" style="font-size: 15px;">è¶Šé‡è·‘</a> <a href="/tags/%E6%84%9F%E8%B0%A2/" style="font-size: 15px;">æ„Ÿè°¢</a> <a href="/tags/%E6%BB%B4%E6%BB%B4/" style="font-size: 15px;">æ»´æ»´</a> <a href="/tags/%E6%80%9D%E8%80%83/" style="font-size: 15px;">æ€è€ƒ</a> <a href="/tags/%E6%97%85%E8%A1%8C/" style="font-size: 15px;">æ—…è¡Œ</a> <a href="/tags/%E6%84%9F%E6%80%A7/" style="font-size: 15px;">æ„Ÿæ€§</a> <a href="/tags/%E9%9D%92%E5%B2%9B/" style="font-size: 15px;">é’å²›</a> <a href="/tags/%E5%BE%92%E6%AD%A5/" style="font-size: 15px;">å¾’æ­¥</a> <a href="/tags/Unity/" style="font-size: 15px;">Unity</a> <a href="/tags/Android/" style="font-size: 15px;">Android</a> <a href="/tags/WatchOS/" style="font-size: 15px;">WatchOS</a> <a href="/tags/Combine/" style="font-size: 15px;">Combine</a> <a href="/tags/django/" style="font-size: 15px;">django</a> <a href="/tags/%E5%AE%9E%E4%B9%A0/" style="font-size: 15px;">å®ä¹ </a> <a href="/tags/%E5%BE%AE%E4%BF%A1/" style="font-size: 15px;">å¾®ä¿¡</a> <a href="/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/" style="font-size: 15px;">å°ç¨‹åº</a> <a href="/tags/UML/" style="font-size: 15px;">UML</a> <a href="/tags/%E6%90%9E%E4%BA%8B%E6%83%85%E7%B3%BB%E5%88%97/" style="font-size: 15px;">æäº‹æƒ…ç³»åˆ—</a> <a href="/tags/%E4%B8%83%E7%89%9B%E4%BA%91/" style="font-size: 15px;">ä¸ƒç‰›äº‘</a> <a href="/tags/Java/" style="font-size: 15px;">Java</a> <a href="/tags/Spring/" style="font-size: 15px;">Spring</a> <a href="/tags/Mybatis/" style="font-size: 15px;">Mybatis</a> <a href="/tags/Junit/" style="font-size: 15px;">Junit</a> <a href="/tags/log4j/" style="font-size: 15px;">log4j</a> <a href="/tags/mysql/" style="font-size: 15px;">mysql</a> <a href="/tags/Spring-MVC/" style="font-size: 15px;">Spring MVC</a> <a href="/tags/%E5%9B%BD%E9%99%85%E5%8C%96/" style="font-size: 15px;">å›½é™…åŒ–</a> <a href="/tags/%E6%BC%94%E8%AE%B2/" style="font-size: 15px;">æ¼”è®²</a> <a href="/tags/%E5%8D%B3%E6%97%B6%E9%80%9A%E8%AE%AF/" style="font-size: 15px;">å³æ—¶é€šè®¯</a> <a href="/tags/side-project/" style="font-size: 15px;">side project</a> <a href="/tags/Qt/" style="font-size: 15px;">Qt</a> <a href="/tags/C-%E8%B7%A8%E7%AB%AF/" style="font-size: 15px;">C++ è·¨ç«¯</a> <a href="/tags/C/" style="font-size: 15px;">C++</a> <a href="/tags/%E5%93%8D%E5%BA%94%E5%BC%8F/" style="font-size: 15px;">å“åº”å¼</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> è”ç³»æˆ‘</i></div><ul></ul><a href="https://github.com/windstormeye" title="GitHub - PJHubs" target="_blank">GitHub - PJHubs</a><ul></ul><a href="https://www.xiaohongshu.com/user/profile/5f2cd0360000000001001470" title="å°çº¢ä¹¦ - PJHubs" target="_blank">å°çº¢ä¹¦ - PJHubs</a><ul></ul><a href="https://www.instagram.com/pjhubs/" title="Instagram - PJHubs" target="_blank">Instagram - PJHubs</a><ul></ul><a href="https://space.bilibili.com/25392474" title="BiliBili - PJHubs" target="_blank">BiliBili - PJHubs</a><ul></ul><a href="https://twitter.com/wengpeijun" title="Twitter - PJHubs" target="_blank">Twitter - PJHubs</a><ul></ul><a href="." title="é‚®ç®± - 877302410@qq.com" target="_blank">é‚®ç®± - 877302410@qq.com</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright Â© 2025 PJHubs</div></div></div><script type="text/javascript" src="//cdn.jsdelivr.net/gh/fancyapps/fancybox/dist/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=1.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox/dist/jquery.fancybox.min.css"><script type="text/javascript" src="/js/copycode.js" successtext="Copy Successed!"></script><link rel="stylesheet" type="text/css" href="/css/copycode.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=1.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=1.0.0"></script></div></body></html>